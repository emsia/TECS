{% extends "base/base_suadmin.html" %}
{% load staticfiles %}

{% block title %}
TECS: Test Essay Checking Software | Home
{% endblock %}

{% block content %}
<head>
	<script src="{% static 'base/js/jquery.min.js' %}"></script>

	<script>
	    $(function() {
		    var tooltips = $( "[title]" ).tooltip();
		    $(document)(function() {
		    	tooltips.tooltip( "open" );
		    })
	    });
	</script>
	
</head>

<div class="page-content">
	<div class="row-fluid">
		<div class="content">
			<p class="pull-right">
				<a href="{% url 'schools:addAdmin' school.id %}" data-toggle="tooltip" data-trigger="hover" data-placement="left" title data-original-title="Add School Admin" class="btn btn-warning"><i class="fui-plus"></i></a>
				<a href="{% url 'schools:edit' school.id %}" data-toggle="tooltip" data-trigger="hover" data-placement="left" title data-original-title="Edit School Info" class="btn btn-warning"><i class="fui-new"></i></a>
			</p>
			<img class="title-icons" src={% static 'base/img/icons/chalkboard-icon.png' %}>
			<h3 class="title">{{ school }}</h3>
			
			{% if error and message %}
				<div class="alert alert-block alert-error">
					<button type="button" class="close" data-dismiss="alert">&times;</button>
		          <h4><strong>Oops!</strong></h4>
		          {{ message }}
		        </div>
		    {% elif message and teacher_list.all.count %}
		    <div class="alert alert-block alert-success">
				<button type="button" class="close" data-dismiss="alert">&times;</button>
	          <h4><strong>Success!</strong></h4> {{ message }}
	        </div>
		    {% endif %}

			{% if hasAdmin %}
			<table class="table table-striped">
				<thead>
					<tr>
						<th><center>#</center></th>
						<th><center>Last Name</center></th>
						<th><center>First name</center></th>
						<th><center>Email</center></th>
						<th><center>Status</center></th>
						<th><center>Resend Password</center></th>
						<th><center>Remove</center></th>
					</tr>
				</thead>
				<tbody>
					{% for admin in adminList %}
					<tr>
						<td><center>{{forloop.counter}}</center></td>
						<td><center>{{admin.user.last_name}}</center></td>
						<td><center>{{admin.user.first_name}}</center></td>
						<td><center>{{admin.user.email}}</center></td>
						<td><center>{% if admin.user.is_active %}<center style="color:#1abc9c">Active</center>
						{% else %}<center style="color:red">Inactive</center></td>{% endif %} 
						<td><center><a 
						{% if admin.user.is_active %}
							href="#"
							class="btn btn-success disabled fui-lock"
						{% else %}
							href="#sendPass"
							class="btn btn-success fui-lock"
						{% endif %}
						role="button" class="sendpass-button btn btn-danger" data-admin_id={{ admin.user.id }} data-username={{ admin.user.username }} data-user_account={{ admin.id }} data-toggle="modal" data-trigger="hover" data-target="#sendPass" data-placement="left" title data-original-title="Send New Password" ></a></center></td>
						<td><center><button type="button" class="delsys-button btn btn-danger" data-id={{ admin.id }} data-toggle="modal" data-target="#confirm-delete"><i class="fui-cross"></i></button></center></td>
					</tr>	
					{% endfor %}			
				</tbody>
			</table>
			{% else %}
					<div class="alert alert-block alert-error">
			          <h4><strong>Oops!</strong></h4>
			          You haven't added admins yet.
			        </div>
			{% endif %}
		</div>
	</div>
</div>

<form action="{% url 'schools:removeAdmin' %}" method="post">
<div id="confirm-delete" class="modal hide fade" data-backdrop="static">
		<div class="modal-header palette-alizarin">
			<h3 class="text-white">Confirm Delete</h3>
		</div>
		<div class="modal-body">
			<p>Are you sure you want to delete this admin from {{ school.short_name }}?</p>
			<p>Continuing with this action, will erase his/her account on this school. </p>{% csrf_token %}
				<input type="hidden" id="admin_id" name="admin_id" value="">
				<input type="hidden" id="school_id" name="school_id" value={{school.id}}>
			
		</div>
		<div class="modal-footer">
			<button type="submit" name="gradesys-delete" class="btn btn-danger pull-left">Delete <span class="fui-cross"></span></button>
			<button class="btn btn-inverse" data-dismiss="modal" aria-hidden="true">Close</button>
		</div>
</div>
</form>

<form action="{% url 'schools:send_newPassword' %}" method="post">
<div id="sendPass" class="modal hide fade" data-backdrop="static">
	<div class="modal-header palette-peter-river">
		<h3 class="text-white">Send New Password</h3>
	</div>
	<div class="modal-body"><p>Password will be automatically generated by the system and will be sent to the email you'll type.</p><br/>
			<p>Type email here.</p>{% csrf_token %}
			<input type="text" class="span6" id="newMail" name="newMail" value="">
			<input type="hidden" id="username" name="username" value="">
			<input type="hidden" id="user_account" name="user_account" value="">
			<input type="hidden" id="admin_id" name="admin_id" value="">
	</div>
	<div class="modal-footer">
		<button type="submit" name="gradesys-delete" class="btn btn-info pull-left">Send <span class="fui-check"></span></button>
		<button class="btn btn-inverse" data-dismiss="modal" aria-hidden="true">Close</button>
	</div>
</div>
</form>

<script>
	$(".delsys-button").on("click", function() {
		var admin_id = $(this).data('id')
		$("#admin_id").val(admin_id)
	});
	$(".sendpass-button").on("click", function() {
		var admin_id = $(this).data('admin_id')
		var user_account = $(this).data('user_account')
		var username = $(this).data('username')
		$("#admin_id").val(admin_id)
		$("#user_account").val(user_account)
		$("#username").val(username)
	});
</script>

<script src="{% static 'base/js/jquery.min.js' %}"></script>

{% endblock %}