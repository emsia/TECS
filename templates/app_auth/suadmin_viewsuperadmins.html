{% extends "base/base_suadmin.html" %}
{% load staticfiles %}

{% block title %}
TECS: Test Essay Checking Software | Super Admin
{% endblock %}

{% block content %}

<div class="page-content">
	<div class="row-fluid">
		<div class="content">
			<div class="row-fluid">
				<p class="pull-right">
					<a href="{% url 'auth:addsuperadmin' %}" class="btn btn-warning"><i class="fui-plus"></i>Add New Super Admin</a>
				</p>
				<img class="title-icons" src="{% static 'base/img/icons/tie.png' %}">
				<h3 class="title">Super Admins</h3>	
				<table class="table table-striped">
					<thead>
						<tr>
							<th style="width: 5%">#</th>
							<th style="width: 2%"></th>
							<th style="width: 20%">Username</th>
							<th style="width: 20%">Last Name</th>
							<th style="width: 20%">First Name</th>
							<th style="width: 13%">Status</th>
							<th style="width: 20%"></th>
						</tr>
					</thead>
					<tbody>
						{% for superadmin in superadmins %}		
							<tr>
								<td>{{forloop.counter}}</td>
								<td>
									{% if superadmin.registered_by.pk == user.pk %}
										<span class="fui-user text-info"></span>
									{% endif %}
								</td>
								<td>
									{{superadmin.user.username}}
									{% if superadmin.user == user %}
										(You)
									{% endif %}
								</td>
								<td>{{superadmin.user.last_name }}</td>
								<td>{{superadmin.user.first_name }}</td>
								<td>			
									{% if superadmin.status == 1 %}
										<span class="fui-check-inverted-2"></span> Active
									{% else %}
										<span class="fui-radio-unchecked"></span> Inactive
									{% endif %}
									
								</td>								
								<td>
									{% if superadmin.status == 1 %}
										<a href="{% url 'auth:suadmin_viewsuperadmindetails' superadmin.user.username %}" class="btn btn-info pull-right">View</a>
									{% else %}
										<button id="cancel-activation-trigger" class="btn btn-info btn-danger pull-right" data-id={{superadmin.user.pk}} data-username={{superadmin.user.username}} data-toggle="modal" data-target="#confirm-cancel-activation">Cancel Activation</button>
									{% endif %}
								</td>
							</tr>
						
						{% endfor %}
					</tbody>
				</table>
			<hr>
			<p class="text-info">Accounts marked with <span class="fui-user"></span> are accounts you created.</p>
			</div>
		</div>
	</div>
</div>

<form action="" method="post">
<div id="confirm-cancel-activation" class="modal hide fade" data-backdrop="static">
		<div class="modal-header palette-alizarin">
			<h3 class="text-white">Confirm Cancel Activation</h3>
		</div>
		<div id="cancel-activation-body" class="modal-body">
			<h4>Cancel pending account activation for <strong><span id="username-container"></span></strong></h4>
			<hr>
			<p>Are you sure you want to cancel the pending activation for this account?</p>
			<p>Continuing this action will invalidate the activation sent to his email address and remove his inactive account from the system. Please take note that this action <span class="text-error"><strong>CANNOT BE UNDONE</strong></span>. </p>{% csrf_token %}
				<input type="hidden" id="user_id" name="user_id" value="">			
		</div>
		<div class="modal-footer">
			<button type="submit" class="btn btn-danger pull-left"><span class="fui-cross"></span> Cancel Activation</button>
			<button class="btn btn-inverse" data-dismiss="modal" aria-hidden="true">Close</button>
		</div>
</div>
</form>

<script>
	$("#cancel-activation-trigger").on("click", function() {
		var id = $(this).data('id');
		var username = $(this).data('username');
		$('#cancel-activation-body #username-container').text(username);
		$("#user_id").val(id);
	});
</script>

{% endblock %}